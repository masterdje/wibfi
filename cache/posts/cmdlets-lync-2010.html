<p class="alert alert-info">Collection de cmdlets Lync 2010  ...</p>
<!-- TEASER_END -->
<div class="section" id="desactiver-l-acces-lync-d-un-utilisateur">
<h2>Désactiver l'accès lync d'un utilisateur</h2>
<pre class="code powershell literal-block">
<span class="nb">Disable-CSuser</span> <span class="n">-Identity</span> <span class="p">[</span><span class="n">identit</span><span class="err">é</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="activation-d-un-utilisateur-administrateur-du-domaine">
<h2>Activation d'un utilisateur Administrateur du domaine</h2>
<pre class="code powershell literal-block">
<span class="nb">Enable-CsUser</span> <span class="n">-Identity</span> <span class="p">[</span><span class="n">identit</span><span class="err">é</span><span class="p">]</span> <span class="n">-RegistrarPool</span> <span class="no">[lepooldudomaine]</span> <span class="n">-SipAddressType</span> <span class="n">SamAccountName</span> <span class="n">-SipDomain</span> <span class="no">[nomdusipdomain]</span>
</pre>
<ul class="simple">
<li>Attention, nécessite aussi la manip' dans <em>dsa.msc</em></li>
</ul>
</div>
<div class="section" id="parametrage-du-type-de-conference">
<h2>Paramétrage du type de conférence</h2>
<ul class="simple">
<li>Nécessaire pour les comptes d'administrateurs domaine/entreprise, pour les comptes lambda, l'interface console suffit.</li>
<li>Manip supplémentaire à effectuer coté AD pour activer les Admins (Domaine, Entreprise)</li>
<li>un seul utilisateur :</li>
</ul>
<pre class="code powershell literal-block">
<span class="n">Grant-CsConferencingPolicy</span> <span class="n">-identity</span> <span class="no">[identity]</span> <span class="n">-PolicyName</span> <span class="no">[nomdelapolicy]</span>
</pre>
<p><em>variante  :</em></p>
<pre class="code powershell literal-block">
<span class="nb">Get-CsUser</span> <span class="n">-Identity</span> <span class="no">[identity]</span> <span class="p">|</span> <span class="n">Grant-CsConferencingPolicy</span> <span class="n">-PolicyName</span> <span class="no">[nomdelapolicy]</span>
</pre>
<ul class="simple">
<li>toute une <strong>OU</strong> à la fois :</li>
</ul>
<pre class="code powershell literal-block">
<span class="nb">Get-CsUser</span> <span class="n">-OU</span> <span class="s2">&quot;OU=Utilisateurs,OU=Administrateurs,dc=XX,dc=XX&quot;</span> <span class="p">|</span> <span class="n">Grant-CsConferencingPolicy</span> <span class="n">-PolicyName</span> <span class="no">[nomdelapolicy]</span>
</pre>
</div>
<div class="section" id="creer-une-nouvelle-strategie-de-client">
<h2>Créer une nouvelle Stratégie de client</h2>
<pre class="code powershell literal-block">
<span class="nb">New-CsClientPolicy</span>
</pre>
<ul class="simple">
<li>Attention, cette stratégie n'est PAS visible dans l'interface d'admin silverlight, juste visible par cmdlet.</li>
</ul>
</div>
<div class="section" id="empecher-l-affichage-des-contacts-outlooks-dans-le-client-lync">
<h2>Empêcher l'affichage des contacts Outlooks dans le client Lync</h2>
<pre class="code powershell literal-block">
<span class="nb">Set-CsClientPolicy</span> <span class="n">-identity</span> <span class="no">[nom de la policy choisie]</span> <span class="n">-ExcludedContactFolders</span> <span class="s2">&quot;Contacts;Contacts suggérés;IPM.Contact&quot;</span>
</pre>
<ul class="simple">
<li>Ne pas oublier de positionner cette policy en tant que Stratégie de client, pour l'utilisateur concerné.</li>
<li>... Et redémarrer Lync. (La déco est insuffisante)</li>
</ul>
</div>
<div class="section" id="verification-de-la-replication-lync-edge">
<h2>Vérification de la réplication lync &lt;-&gt; Edge</h2>
<ul class="simple">
<li>A jouer depuis serveur lync</li>
</ul>
<pre class="code powershell literal-block">
<span class="nb">Get-CsManagementStoreReplicationStatus</span>
</pre>
<p>Doit produire :</p>
<pre class="code bash literal-block">
UpToDate           : True
ReplicaFqdn        : serveur.fqdn
LastStatusReport   : 09/10/2013 11:48:35
LastUpdateCreation : 09/10/2013 09:53:27
ProductVersion     : 4.0.7577.0

UpToDate           : True
ReplicaFqdn        : edge.fqdn
LastStatusReport   : 09/10/2013 09:53:30
LastUpdateCreation : 09/10/2013 09:53:27
ProductVersion     : 4.0.7577.0
</pre>
<ul class="simple">
<li><em>Uptodate</em> doit donc être <strong>true</strong> et <em>LastUpdateCreation</em> présenter un horaire identique</li>
</ul>
</div>
<div class="section" id="forcer-la-replication-lync-edge">
<h2>Forcer la réplication lync &lt;-&gt; Edge</h2>
<ul class="simple">
<li>A jouer depuis serveur lync</li>
</ul>
<pre class="code powershell literal-block">
<span class="nb">invoke-csmanagementstorereplication</span>
</pre>
</div>
