<p class="alert alert-info">Collection de vieux scripts vbs fonctionnels, au cas où ...</p>
<!-- TEASER_END -->
<div class="section" id="lecture-d-un-fichier">
<h2>LECTURE d'un fichier</h2>
<pre class="code vb.net literal-block">
<span class="c">'déclaration file system object Dim fso
</span>
<span class="c">'instanciation
</span><span class="k">Set</span> <span class="n">FSO</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;Scripting.FileSystemObject&quot;</span><span class="p">)</span>

<span class="c">'on instance le fichier texte
</span><span class="k">Set</span> <span class="n">Ftxt</span> <span class="o">=</span> <span class="n">FSO</span><span class="p">.</span><span class="n">OpenTextFile</span><span class="p">(</span><span class="s">&quot;Monchemin&quot;</span><span class="p">)</span>

<span class="c">'on parcourt chaque ligne du fichier texte
</span><span class="k">Do</span> <span class="k">While</span> <span class="k">Not</span> <span class="n">Ftxt</span><span class="p">.</span><span class="n">AtEndOfStream</span>
        <span class="n">MaVariable</span> <span class="o">=</span> <span class="n">Ftxt</span><span class="p">.</span><span class="n">Readline</span>
        <span class="c">'...;- votre code ici pour traiter chaque ligne
</span><span class="k">Loop</span>
<span class="n">Ftxt</span><span class="p">.</span><span class="n">Close</span>
</pre>
</div>
<div class="section" id="ecriture-dans-un-fichier">
<h2>ECRITURE dans un fichier</h2>
<pre class="code vb.net literal-block">
<span class="c">'déclaration file system object
</span><span class="k">Dim</span> <span class="n">fso</span>

<span class="c">'instanciation
</span><span class="k">Set</span> <span class="n">FSO</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;Scripting.FileSystemObject&quot;</span><span class="p">)</span>

<span class="c">'on instance le fichier texte dans lequel on veut ecrire
</span><span class="k">Set</span> <span class="n">Ftxt</span> <span class="o">=</span> <span class="n">FSO</span><span class="p">.</span><span class="n">createTextFile</span><span class="p">(</span><span class="s">&quot;Monchemin&quot;</span><span class="p">,</span><span class="k">true</span><span class="p">)</span> <span class="c">'true=ecrase
</span>
<span class="c">'On ecrit ce que l'on veut dans le fichier
</span><span class="n">Ftxt</span><span class="p">.</span><span class="n">writeline</span> <span class="p">(</span><span class="s">&quot;Mon texte à écrire ou ma Variable texte&quot;</span><span class="p">)</span>

<span class="n">Ftxt</span><span class="p">.</span><span class="n">Close</span>
</pre>
</div>
<div class="section" id="deplacer-un-fichier">
<h2>DEPLACER un fichier</h2>
<pre class="code vb.net literal-block">
<span class="c">'déclaration file system object
</span><span class="k">Dim</span> <span class="n">fso</span>

<span class="c">'instanciation
</span><span class="k">Set</span> <span class="n">FSO</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;Scripting.FileSystemObject&quot;</span><span class="p">)</span>

<span class="c">'Déplacement du fichier
</span><span class="k">Set</span> <span class="n">Ftxt</span> <span class="o">=</span> <span class="n">fso</span><span class="p">.</span><span class="n">GetFile</span><span class="p">(</span><span class="s">&quot;moncheminsource&quot;</span><span class="p">)</span>
<span class="c">'Fichier origine
</span><span class="n">Ftxt</span><span class="p">.</span><span class="n">move</span><span class="p">(</span><span class="s">&quot;monchemindestination&quot;</span><span class="p">)</span> <span class="c">'emplacement destination</span>
</pre>
</div>
<div class="section" id="copier-un-fichier">
<h2>COPIER un fichier</h2>
<pre class="code vb.net literal-block">
<span class="c">'déclaration file system object
</span><span class="k">Dim</span> <span class="n">fso</span>

<span class="c">'instanciation
</span><span class="k">Set</span> <span class="n">FSO</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;Scripting.FileSystemObject&quot;</span><span class="p">)</span>

<span class="c">'Copie du fichier
</span><span class="k">Set</span> <span class="n">Ftxt</span> <span class="o">=</span> <span class="n">fso</span><span class="p">.</span><span class="n">GetFile</span><span class="p">(</span><span class="s">&quot;moncheminsource&quot;</span><span class="p">)</span>
<span class="c">'Fichier origine
</span><span class="n">Ftxt</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="s">&quot;monchemindestination&quot;</span><span class="p">)</span> <span class="c">'emplacement destination</span>
</pre>
</div>
<div class="section" id="supprimer-un-fichier">
<h2>SUPPRIMER un fichier</h2>
<pre class="code vb.net literal-block">
<span class="c">'déclaration file system object Dim fso
</span>
<span class="c">'instanciation
</span><span class="k">Set</span> <span class="n">FSO</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;Scripting.FileSystemObject&quot;</span><span class="p">)</span>

<span class="c">'Suppression du fichier
</span><span class="k">Set</span> <span class="n">Ftxt</span> <span class="o">=</span> <span class="n">fso</span><span class="p">.</span><span class="n">GetFile</span><span class="p">(</span><span class="s">&quot;moncheminsource&quot;</span><span class="p">)</span>
<span class="c">'Fichier origine
</span><span class="n">Ftxt</span><span class="p">.</span><span class="n">delete</span>
</pre>
</div>
<div class="section" id="lister-les-fichiers-d-un-dossier">
<h2>LISTER les fichiers d'un dossier</h2>
<pre class="code vb.net literal-block">
<span class="k">Const</span> <span class="n">ctePourLecture</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">Const</span> <span class="n">ctePourEcrire</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">Const</span> <span class="n">ctePourAjouter</span> <span class="o">=</span> <span class="mi">8</span>

<span class="k">Dim</span> <span class="n">objFSO</span><span class="p">,</span> <span class="n">objDossier</span><span class="p">,</span> <span class="n">objFichier</span><span class="p">,</span> <span class="n">objResultat</span>
<span class="k">Dim</span> <span class="n">Repertoire</span><span class="p">,</span> <span class="n">NomFichierTxt</span>

<span class="k">On</span> <span class="k">Error</span> <span class="k">Resume</span> <span class="k">Next</span>

<span class="n">Repertoire</span> <span class="o">=</span> <span class="s">&quot;\\MONSERVEUR\scripts&quot;</span>
<span class="n">NomFichierTxt</span> <span class="o">=</span> <span class="s">&quot;Resultat.txt&quot;</span>
<span class="k">Set</span> <span class="n">objFSO</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;Scripting.FileSystemObject&quot;</span><span class="p">)</span>
<span class="k">Set</span> <span class="n">objDossier</span> <span class="o">=</span> <span class="n">objFSO</span><span class="p">.</span><span class="n">GetFolder</span><span class="p">(</span><span class="n">Repertoire</span><span class="p">)</span>
<span class="k">Set</span> <span class="n">objResultat</span> <span class="o">=</span> <span class="n">objFSO</span><span class="p">.</span><span class="n">CreateTextFile</span><span class="p">((</span><span class="s">&quot;c:&quot;</span> <span class="o">&amp;</span> <span class="s">&quot;\&quot;</span> <span class="o">&amp;</span> <span class="n">NomFichierTxt</span><span class="p">),</span><span class="n">ctePourEcrire</span><span class="p">)</span>


<span class="k">If</span> <span class="p">(</span><span class="n">objDossier</span><span class="p">.</span><span class="n">Files</span><span class="p">.</span><span class="n">Count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
   <span class="k">For</span> <span class="k">Each</span> <span class="n">objFichier</span> <span class="ow">In</span> <span class="n">objDossier</span><span class="p">.</span><span class="n">Files</span>
      <span class="k">If</span> <span class="p">(</span><span class="n">InStr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">objFichier</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="s">&quot;.bat&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
          <span class="n">objResultat</span><span class="p">.</span><span class="n">WriteLine</span> <span class="n">objFichier</span><span class="p">.</span><span class="n">Name</span>
      <span class="k">End</span> <span class="k">If</span>
   <span class="k">Next</span>
 <span class="k">End</span> <span class="k">If</span>

<span class="n">objResultat</span><span class="p">.</span><span class="n">Close</span>
<span class="k">Set</span> <span class="n">objResultat</span> <span class="o">=</span> <span class="k">Nothing</span>
<span class="k">Set</span> <span class="n">objDossier</span> <span class="o">=</span> <span class="k">Nothing</span>
<span class="k">Set</span> <span class="n">objFSO</span> <span class="o">=</span> <span class="k">Nothing</span>
</pre>
</div>
<div class="section" id="lister-les-sous-dossiers-d-un-dossier">
<h2>LISTER les sous-dossiers d'un dossier</h2>
<pre class="code vb.net literal-block">
<span class="k">Set</span> <span class="n">objFSO</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;Scripting.FileSystemObject&quot;</span><span class="p">)</span>
<span class="k">Set</span> <span class="n">objFolder</span> <span class="o">=</span> <span class="n">objFSO</span><span class="p">.</span><span class="n">GetFolder</span><span class="p">(</span><span class="s">&quot;c:\windows&quot;</span><span class="p">)</span>
<span class="k">Set</span> <span class="n">colSubfolders</span> <span class="o">=</span> <span class="n">objFolder</span><span class="p">.</span><span class="n">Subfolders</span>
<span class="k">For</span> <span class="k">Each</span> <span class="n">objSubfolder</span> <span class="ow">in</span> <span class="n">colSubfolders</span>
        <span class="n">msgbox</span> <span class="n">objSubfolder</span><span class="p">.</span><span class="n">name</span>
<span class="k">next</span>
</pre>
</div>
<div class="section" id="concatenation-de-fichiers-d-un-dossier">
<h2>CONCATENATION de fichiers d'un dossier</h2>
<pre class="code vb.net literal-block">
    <span class="k">On</span> <span class="k">error</span> <span class="k">resume</span> <span class="k">next</span>
    <span class="k">Dim</span> <span class="n">fso</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">fd</span><span class="p">,</span><span class="n">txt</span><span class="p">,</span><span class="n">Dest</span>
    <span class="k">Const</span> <span class="n">ForAppending</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ForReading</span><span class="o">=</span><span class="mi">1</span>

    <span class="n">critere</span> <span class="o">=</span> <span class="s">&quot;BAT&quot;</span> <span class="c">'à mettre en majuscules, pour éviter les erreurs
</span>    <span class="n">dossier_cible</span> <span class="o">=</span><span class="s">&quot;\\MONSERVEUR\scripts&quot;</span>
    <span class="n">fic_cible</span><span class="o">=</span> <span class="s">&quot;C:\resultats.txt&quot;</span>

    <span class="k">Set</span> <span class="n">fso</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;Scripting.FileSystemObject&quot;</span><span class="p">)</span>
    <span class="k">set</span> <span class="n">fd</span><span class="o">=</span><span class="n">fso</span><span class="p">.</span><span class="n">GetFolder</span><span class="p">(</span><span class="n">dossier_cible</span><span class="p">)</span>
    <span class="k">Set</span> <span class="n">Dest</span><span class="o">=</span><span class="n">fso</span><span class="p">.</span><span class="n">OpenTextFile</span><span class="p">(</span><span class="n">fic_cible</span><span class="p">,</span><span class="n">ForAppending</span><span class="p">,</span><span class="k">true</span><span class="p">)</span>

<span class="k">for</span> <span class="k">each</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fd</span><span class="p">.</span><span class="n">files</span>
    <span class="k">If</span> <span class="n">Ucase</span><span class="p">(</span><span class="n">Mid</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="n">len</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">=</span><span class="n">critere</span> <span class="k">Then</span>

    <span class="k">Set</span> <span class="n">fic</span><span class="o">=</span><span class="n">fso</span><span class="p">.</span><span class="n">OpenTextFile</span><span class="p">(</span><span class="n">fd</span> <span class="o">&amp;</span> <span class="s">&quot;\&quot;</span> <span class="o">&amp;</span> <span class="n">f</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="n">ForReading</span><span class="p">)</span>
   <span class="n">txt</span><span class="o">=</span><span class="n">fic</span><span class="p">.</span><span class="n">ReadAll</span>
            <span class="n">fic</span><span class="p">.</span><span class="n">close</span>
            <span class="n">Dest</span><span class="p">.</span><span class="n">Write</span> <span class="n">f</span><span class="p">.</span><span class="n">name</span> <span class="o">&amp;</span> <span class="n">txt</span> <span class="o">&amp;</span> <span class="n">vbcrlf</span> <span class="c">'afficher le nom du fichier &amp; son contenu
</span>            <span class="c">'Dest.Write txt 'afficher seulement le contenu du fichier
</span>    <span class="k">End</span> <span class="k">if</span>
    <span class="k">next</span>
    <span class="n">Dest</span><span class="p">.</span><span class="n">Close</span>
</pre>
</div>
<div class="section" id="lecture-d-un-fichier-csv">
<h2>LECTURE d'un fichier CSV</h2>
<pre class="code vb.net literal-block">
<span class="k">Set</span> <span class="n">FSO</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;Scripting.FileSystemObject&quot;</span><span class="p">)</span>
<span class="k">Set</span> <span class="n">Ftxt</span> <span class="o">=</span> <span class="n">FSO</span><span class="p">.</span><span class="n">OpenTextFile</span><span class="p">(</span><span class="s">&quot;liste.csv&quot;</span><span class="p">)</span>

<span class="k">Do</span> <span class="k">While</span> <span class="k">Not</span> <span class="n">Ftxt</span><span class="p">.</span><span class="n">AtEndOfStream</span>
<span class="n">MaVariable</span> <span class="o">=</span> <span class="n">Ftxt</span><span class="p">.</span><span class="n">Readline</span>

<span class="k">For</span> <span class="k">Each</span> <span class="n">strItem</span> <span class="ow">In</span> <span class="n">CSVParse</span><span class="p">(</span><span class="n">mavariable</span><span class="p">)</span>
<span class="c">'    wscript.Echo strItem ' affiche le contenu du fichier csv, champs apres champs ...
'... inserer le code ici
</span><span class="k">Next</span>
<span class="k">Loop</span>
<span class="n">Ftxt</span><span class="p">.</span><span class="n">Close</span>

<span class="k">Function</span> <span class="nf">CSVParse</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">strLine</span><span class="p">)</span>
        <span class="k">Dim</span> <span class="n">arrFields</span>
        <span class="k">Dim</span> <span class="n">blnIgnore</span>
        <span class="k">Dim</span> <span class="n">intFieldCount</span>
        <span class="k">Dim</span> <span class="n">intCursor</span>
        <span class="k">Dim</span> <span class="n">intStart</span>
        <span class="k">Dim</span> <span class="n">strChar</span>
        <span class="k">Dim</span> <span class="n">strValue</span>

        <span class="k">Const</span> <span class="n">QUOTE</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;&quot;</span>
        <span class="k">Const</span> <span class="n">QUOTE2</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;&quot;&quot;&quot;</span>

        <span class="k">If</span> <span class="p">(</span><span class="n">Len</span><span class="p">(</span><span class="n">Trim</span><span class="p">(</span><span class="n">strLine</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
                <span class="n">CSVParse</span> <span class="o">=</span> <span class="n">Array</span><span class="p">()</span>
                <span class="k">Exit</span> <span class="k">Function</span>
        <span class="nf">End</span> <span class="k">If</span>
        <span class="n">blnIgnore</span> <span class="o">=</span> <span class="k">False</span>
        <span class="n">intFieldCount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">intStart</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">arrFields</span> <span class="o">=</span> <span class="n">Array</span><span class="p">()</span>
        <span class="n">strLine</span> <span class="o">=</span> <span class="n">strLine</span> <span class="o">&amp;</span> <span class="s">&quot;,&quot;</span>

        <span class="k">For</span> <span class="n">intCursor</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">Len</span><span class="p">(</span><span class="n">strLine</span><span class="p">)</span>

<span class="n">strChar</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">strLine</span><span class="p">,</span> <span class="n">intCursor</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">Select</span> <span class="k">Case</span> <span class="n">strChar</span>
    <span class="k">Case</span> <span class="n">QUOTE</span>

        <span class="n">blnIgnore</span> <span class="o">=</span> <span class="k">Not</span> <span class="n">blnIgnore</span>
    <span class="k">Case</span> <span class="s">&quot;,&quot;</span>
        <span class="k">If</span> <span class="k">Not</span> <span class="n">blnIgnore</span> <span class="k">Then</span>

            <span class="k">ReDim</span> <span class="n">Preserve</span> <span class="n">arrFields</span><span class="p">(</span><span class="n">intFieldCount</span><span class="p">)</span>

            <span class="k">If</span> <span class="p">(</span><span class="n">intCursor</span> <span class="o">-</span> <span class="n">intStart</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>

                <span class="n">strValue</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">strLine</span><span class="p">,</span> <span class="n">intStart</span><span class="p">,</span> <span class="n">_</span>
                    <span class="n">intCursor</span> <span class="o">-</span> <span class="n">intStart</span><span class="p">)</span>

                <span class="k">If</span> <span class="p">(</span><span class="n">Left</span><span class="p">(</span><span class="n">strValue</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">QUOTE</span><span class="p">)</span> <span class="k">Then</span>
                    <span class="n">arrFields</span><span class="p">(</span><span class="n">intFieldCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">_</span>
                        <span class="n">Replace</span><span class="p">(</span><span class="n">Mid</span><span class="p">(</span><span class="n">strValue</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">_</span>
                        <span class="n">Len</span><span class="p">(</span><span class="n">strValue</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="n">QUOTE2</span><span class="p">,</span> <span class="n">QUOTE</span><span class="p">)</span>
                <span class="k">Else</span>
                    <span class="n">arrFields</span><span class="p">(</span><span class="n">intFieldCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">strValue</span>
                <span class="k">End</span> <span class="k">If</span>
            <span class="k">Else</span>
                <span class="n">arrFields</span><span class="p">(</span><span class="n">intFieldCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">Empty</span>
            <span class="k">End</span> <span class="k">If</span>

            <span class="n">intFieldCount</span> <span class="o">=</span> <span class="n">intFieldCount</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">intStart</span> <span class="o">=</span> <span class="n">intCursor</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">End</span> <span class="k">If</span>

                <span class="k">Case</span> <span class="s">&quot;;&quot;</span>
        <span class="k">If</span> <span class="k">Not</span> <span class="n">blnIgnore</span> <span class="k">Then</span>

            <span class="k">ReDim</span> <span class="n">Preserve</span> <span class="n">arrFields</span><span class="p">(</span><span class="n">intFieldCount</span><span class="p">)</span>

            <span class="k">If</span> <span class="p">(</span><span class="n">intCursor</span> <span class="o">-</span> <span class="n">intStart</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>

                <span class="n">strValue</span> <span class="o">=</span> <span class="n">Mid</span><span class="p">(</span><span class="n">strLine</span><span class="p">,</span> <span class="n">intStart</span><span class="p">,</span> <span class="n">_</span>
                    <span class="n">intCursor</span> <span class="o">-</span> <span class="n">intStart</span><span class="p">)</span>

                <span class="k">If</span> <span class="p">(</span><span class="n">Left</span><span class="p">(</span><span class="n">strValue</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">QUOTE</span><span class="p">)</span> <span class="k">Then</span>
                    <span class="n">arrFields</span><span class="p">(</span><span class="n">intFieldCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">_</span>
                        <span class="n">Replace</span><span class="p">(</span><span class="n">Mid</span><span class="p">(</span><span class="n">strValue</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">_</span>
                        <span class="n">Len</span><span class="p">(</span><span class="n">strValue</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="n">QUOTE2</span><span class="p">,</span> <span class="n">QUOTE</span><span class="p">)</span>
                <span class="k">Else</span>
                    <span class="n">arrFields</span><span class="p">(</span><span class="n">intFieldCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">strValue</span>
                <span class="k">End</span> <span class="k">If</span>
            <span class="k">Else</span>
                <span class="n">arrFields</span><span class="p">(</span><span class="n">intFieldCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">Empty</span>
            <span class="k">End</span> <span class="k">If</span>

            <span class="n">intFieldCount</span> <span class="o">=</span> <span class="n">intFieldCount</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">intStart</span> <span class="o">=</span> <span class="n">intCursor</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">End</span> <span class="k">If</span>

                <span class="k">End</span> <span class="k">Select</span>
        <span class="k">Next</span>

        <span class="n">CSVParse</span> <span class="o">=</span> <span class="n">arrFields</span>
<span class="k">End</span> <span class="k">Function</span>
</pre>
</div>
<div class="section" id="liste-des-lecteurs-reseau-montes-methode-wmi">
<h2>Liste des lecteurs réseau montés (méthode WMI)</h2>
<pre class="code vb.net literal-block">
<span class="n">strComputer</span> <span class="o">=</span> <span class="s">&quot;.&quot;</span>
<span class="k">set</span> <span class="n">objWMI</span> <span class="o">=</span> <span class="n">GetObject</span><span class="p">(</span><span class="s">&quot;winmgmts:\\&quot;</span> <span class="o">&amp;</span> <span class="n">strComputer</span> <span class="o">&amp;</span> <span class="s">&quot;\root\cimv2&quot;</span><span class="p">)</span>
<span class="k">set</span> <span class="n">colDrives</span> <span class="o">=</span> <span class="n">objWMI</span><span class="p">.</span><span class="n">ExecQuery</span><span class="p">(</span><span class="s">&quot;select * from Win32_MappedLogicalDisk&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="k">each</span> <span class="n">objDrive</span> <span class="ow">in</span> <span class="n">colDrives</span>
<span class="n">WScript</span><span class="p">.</span><span class="n">Echo</span> <span class="s">&quot;ID: &quot;</span> <span class="o">&amp;</span> <span class="n">objDrive</span><span class="p">.</span><span class="n">DeviceID</span> <span class="o">&amp;</span> <span class="n">vbcrlf</span> <span class="o">&amp;</span> <span class="n">_</span>
                        <span class="s">&quot;Nom: &quot;</span> <span class="o">&amp;</span> <span class="n">objDrive</span><span class="p">.</span><span class="n">VolumeName</span> <span class="o">&amp;</span> <span class="n">vbcrlf</span> <span class="o">&amp;</span> <span class="n">_</span>
                <span class="s">&quot;Taille: &quot;</span> <span class="o">&amp;</span> <span class="n">round</span><span class="p">(</span><span class="n">objDrive</span><span class="p">.</span><span class="n">Size</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s">&quot; Go&quot;</span>
<span class="k">next</span>
</pre>
</div>
<div class="section" id="liste-des-lecteurs-reseau-montes-methode-native-wsh">
<h2>Liste des lecteurs réseau montés (méthode native wsh)</h2>
<pre class="code vb.net literal-block">
<span class="k">Set</span> <span class="n">objNetwork</span> <span class="o">=</span> <span class="n">WScript</span><span class="p">.</span><span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;WScript.Network&quot;</span><span class="p">)</span>
<span class="k">Set</span> <span class="n">colDrives</span> <span class="o">=</span> <span class="n">objNetwork</span><span class="p">.</span><span class="n">EnumNetworkDrives</span>
<span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">to</span> <span class="n">colDrives</span><span class="p">.</span><span class="n">Count</span><span class="o">-</span><span class="mi">1</span> <span class="k">Step</span> <span class="mi">2</span>
        <span class="n">Wscript</span><span class="p">.</span><span class="n">Echo</span> <span class="n">colDrives</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span><span class="s">&quot; - &quot;</span><span class="o">&amp;</span> <span class="n">colDrives</span><span class="p">.</span><span class="n">Item</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">Next</span>
</pre>
</div>
<div class="section" id="mappage-conditionnel-d-un-lecteur-reseau">
<h2>Mappage conditionnel d'un lecteur réseau</h2>
<pre class="code vb.net literal-block">
<span class="k">Dim</span> <span class="n">WshShell</span><span class="p">,</span> <span class="n">EnvVars</span><span class="p">,</span> <span class="n">objNetwork</span><span class="p">,</span> <span class="n">client</span>
<span class="k">Set</span> <span class="n">WshShell</span> <span class="o">=</span> <span class="n">WScript</span><span class="p">.</span><span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;WScript.Shell&quot;</span><span class="p">)</span>
<span class="k">Set</span> <span class="n">objNetwork</span> <span class="o">=</span> <span class="n">Wscript</span><span class="p">.</span><span class="n">CreateObject</span><span class="p">(</span><span class="s">&quot;WScript.Network&quot;</span><span class="p">)</span>
<span class="k">Set</span> <span class="n">colDrives</span> <span class="o">=</span> <span class="n">objNetwork</span><span class="p">.</span><span class="n">EnumNetworkDrives</span>
<span class="n">trouve</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">to</span> <span class="n">colDrives</span><span class="p">.</span><span class="n">Count</span><span class="o">-</span><span class="mi">1</span> <span class="k">step</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">coldrives</span><span class="p">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span><span class="s">&quot;I:&quot;</span> <span class="k">then</span> <span class="n">trouve</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">Next</span>
<span class="k">if</span> <span class="n">trouve</span> <span class="o">&lt;&gt;</span> <span class="mi">1</span> <span class="k">then</span> <span class="n">objNetwork</span><span class="p">.</span><span class="n">MapNetworkDrive</span> <span class="s">&quot;I:&quot;</span><span class="p">,</span> <span class="s">&quot;\\MONSERVEUR\App_Dipp&quot;</span>
</pre>
<ul class="simple">
<li>Ici on ne teste que si la lettre du lecteur est déjà affectée.</li>
</ul>
</div>
