<p class="alert alert-info">Mini script de liste des étendues d'un serveur DHCP distant</p>
<ul class="simple">
<li>Il faut bien sur qu' <em>invoke-command</em> soit autorisé sur le serveur distant  Go go go <em>winRM</em> ...</li>
</ul>
<!-- TEASER_END -->
<div class="section" id="code">
<h2>Code</h2>
<pre class="code powershell literal-block">
<span class="nv">$scope</span> <span class="p">=</span> <span class="nv">$args</span><span class="p">[</span><span class="n">0</span><span class="p">]</span>
<span class="nv">$a</span> <span class="p">=</span> <span class="nb">Invoke-Command</span> <span class="n">-ComputerName</span> <span class="n">fqdn-du-serveur</span> <span class="n">-scriptblock</span><span class="p">{</span><span class="n">netsh</span> <span class="n">dhcp</span> <span class="n">server</span> <span class="n">XXX</span><span class="p">.</span><span class="n">XXX</span><span class="p">.</span><span class="n">XXX</span><span class="p">.</span><span class="n">XXX</span> <span class="n">show</span> <span class="n">scope</span><span class="p">}</span>
<span class="nv">$tabl</span><span class="p">=</span> <span class="nv">$a</span><span class="p">[</span><span class="n">7</span><span class="p">..(</span><span class="nv">$a</span><span class="p">.</span><span class="n">length</span><span class="p">-</span><span class="n">6</span><span class="p">)]</span>
<span class="nv">$ip</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Collections</span><span class="p">.</span><span class="n">ArrayList</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$a</span> <span class="k">in</span> <span class="nv">$tabl</span><span class="p">)</span> <span class="p">{</span><span class="nv">$ip</span><span class="p">.</span><span class="n">add</span><span class="p">(</span> <span class="nv">$a</span><span class="p">.</span><span class="n">trim</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="n">0</span><span class="p">].</span><span class="n">trimend</span><span class="p">())</span> <span class="p">&gt;</span> <span class="nv">$null</span> <span class="p">}</span>
<span class="nv">$ip</span><span class="p">.</span><span class="n">sort</span><span class="p">()</span>
<span class="nv">$ip</span>
</pre>
</div>
<div class="section" id="usage">
<h2>Usage</h2>
<ul class="simple">
<li>A copier dans un fichier <em>.ps1</em></li>
</ul>
</div>
<div class="section" id="infos">
<h2>Infos</h2>
<ul class="simple">
<li>Juste un wrap de <strong>netsh</strong> et un trim/split qui va bien derrière pour garder l'essentiel</li>
</ul>
</div>
