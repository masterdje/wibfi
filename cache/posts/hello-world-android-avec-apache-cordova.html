<p class="alert alert-info">Passage d'<a class="reference external" href="http://cordova.apache.org/announcements/2013/11/22/cordova-320.html">Apache Cordova en v3.2</a>, ça mérite un focus <strong>Hello-world</strong>, pour commencer</p>
<ul class="simple">
<li>ben, comme phonegap, quoi ...</li>
</ul>
<!-- TEASER_END -->
<div class="section" id="d-abord">
<h2>D'abord</h2>
<ul class="simple">
<li>Installer Node.js</li>
</ul>
<pre class="code bash literal-block">
<span class="c">#archlinux...
</span>sudo pacman -S nodejs

<span class="c">#ubuntu
</span>sudo apt-get install nodejs
</pre>
<ul class="simple">
<li>Installer Cordova</li>
</ul>
<pre class="code bash literal-block">
sudo npm install -g cordova

npm http GET https://registry.npmjs.org/cordova
npm http 200 https://registry.npmjs.org/cordova
npm http GET https://registry.npmjs.org/cordova/-/cordova-3.2.0-0.2.0.tgz
npm http 200 https://registry.npmjs.org/cordova/-/cordova-3.2.0-0.2.0.tgz
npm http GET https://registry.npmjs.org/colors
npm http GET https://registry.npmjs.org/elementtree/0.1.5
npm http GET https://registry.npmjs.org/plugman
npm http GET https://registry.npmjs.org/plist
npm http GET https://registry.npmjs.org/xcode/0.6.2
npm http GET https://registry.npmjs.org/express/3.0.0
...
...
</pre>
</div>
<div class="section" id="ensuite">
<h2>Ensuite</h2>
<ul class="simple">
<li>Se positionner dans son dossier de travail (genre ~/mydev ) et lancer la commande qui créera un dossier <strong>hello</strong> , d'<strong>id</strong> <em>com.example.hello</em> ...</li>
</ul>
<pre class="code bash literal-block">
<span class="o">[</span>dje&#64;pc01 mydev<span class="o">]</span><span class="nv">$ </span>cordova create hello com.example.hello Helloworld
Creating a new cordova project with name <span class="s2">&quot;Helloworld&quot;</span> and id <span class="s2">&quot;com.example.hello&quot;</span> at location <span class="s2">&quot;/home/dje/mydev/hello&quot;</span>
Downloading cordova library <span class="k">for </span>www...
...
...
</pre>
<ul class="simple">
<li>Ajouter la platerforme cible <em>android</em></li>
</ul>
<pre class="code bash literal-block">
<span class="o">[</span>dje&#64;pc01 hello<span class="o">]</span><span class="nv">$ </span>cordova platform add android
Downloading cordova library <span class="k">for </span>android...
Download <span class="nb">complete
</span>Checking Android requirements...
<span class="o">[</span>Error: Please install Android target 17 <span class="o">(</span>the Android 4.2 SDK<span class="o">)</span>. Make sure you have the latest Android tools installed as well.
Run <span class="sb">`</span>android<span class="sb">`</span> from your <span class="nb">command</span>-line to install/update any missing SDKs or tools.<span class="o">]</span>
</pre>
<ul class="simple">
<li>OK mon sdk est trop vieux...</li>
</ul>
<pre class="code bash literal-block">
sudo android sdk update
<span class="c">#la fenêtre se lance...
#décocher Api 19 et choisir Api 17 (android 4.2)</span>
</pre>
<ul class="simple">
<li>On recommence une fois le sdk up-to-date</li>
</ul>
<pre class="code bash literal-block">
Checking Android requirements...
Creating android project...
<span class="o">[</span>Error: An error occured during creation of android sub-project.
<span class="o">[</span>Error: ERROR : executing <span class="nb">command</span> <span class="s1">'ant'</span>, make sure you have ant installed and added to your path.<span class="o">]</span>
</pre>
<ul class="simple">
<li>Il faut donc installer <strong>apache-ant</strong></li>
</ul>
<pre class="code bash literal-block">
sudo pacman -S apache-ant
...
Paquets <span class="o">(</span>1<span class="o">)</span>: apache-ant-1.9.2-3
Taille totale de téléchargement : 12,56 MiB
Taille totale installé :           14,25 MiB
...
</pre>
<ul class="simple">
<li>et c'est ok pour l'ajout d'android comme plate-forme cible.</li>
</ul>
<pre class="code bash literal-block">
<span class="o">[</span>dje&#64;pc01 hello<span class="o">]</span><span class="nv">$ </span>cordova platform add android
Checking Android requirements...
Creating android project...
Preparing android project
</pre>
<ul class="simple">
<li>on lance le build du projet <strong>hello</strong></li>
</ul>
<pre class="code bash literal-block">
<span class="o">[</span>dje&#64;pc01 hello<span class="o">]</span><span class="nv">$ </span>cordova build
Generating config.xml from defaults <span class="k">for </span>platform <span class="s2">&quot;android&quot;</span>
Preparing android project
Compiling app on platform <span class="s2">&quot;android&quot;</span> via <span class="nb">command</span> <span class="s2">&quot;/home/dje/dev/hello/platforms/android/cordova/build&quot;</span>
Platform <span class="s2">&quot;android&quot;</span> compiled successfully.
</pre>
<ul class="simple">
<li>test sur émulateur ... qui échoue si on a pas monté d'image</li>
</ul>
<pre class="code bash literal-block">
cordova emulate android
Generating config.xml from defaults <span class="k">for </span>platform <span class="s2">&quot;android&quot;</span>
Preparing android project
Running on emulator <span class="k">for </span>platform <span class="s2">&quot;android&quot;</span> via <span class="nb">command</span> <span class="s2">&quot;/home/dje/dev/hello/platforms/android/cordova/run&quot;</span> --emulator
<span class="o">[</span>Error: An error occurred <span class="k">while </span>emulating/deploying the android project.
/home/dje/dev/hello/platforms/android/cordova/node_modules/q/q.js:126
            throw e;
                  ^
ERROR : No emulator images <span class="o">(</span>avds<span class="o">)</span> found, <span class="k">if </span>you would like to create an avd follow the instructions provided here:
...
</pre>
<ul class="simple">
<li>Donc il faut créér l'émulateur</li>
</ul>
<pre class="code bash literal-block">
android create avd --name emu --target 1 --abi x86
Android 4.2.2 is a basic Android platform.
Do you wish to create a custom hardware profile <span class="o">[</span>no<span class="o">]</span>
Created AVD <span class="s1">'test'</span> based on Android 4.2.2, Intel Atom <span class="o">(</span>x86<span class="o">)</span> processor,
with the following hardware config:
hw.lcd.density<span class="o">=</span>240
vm.heapSize<span class="o">=</span>48
hw.ramSize<span class="o">=</span>512
</pre>
<ul class="simple">
<li><strong>--target</strong> correspond à la version d'android / sdk installée .</li>
<li><strong>--abi</strong> est la plateforme du cpu cible</li>
<li>On peut trouver des infos en jouant <strong>android list target</strong> pour identifier s'y retrouver</li>
<li>Ce sont les options par défaut, qui produisent donc un émulateur de specs vraiment faibles (et x86 est peu judicieux.)</li>
<li>Et lancer l'émulateur une fois l'image validée</li>
</ul>
<pre class="code bash literal-block">
cordova emulate android
Generating config.xml from defaults <span class="k">for </span>platform <span class="s2">&quot;android&quot;</span>
Preparing android project
Running on emulator <span class="k">for </span>platform <span class="s2">&quot;android&quot;</span> via <span class="nb">command</span> <span class="s2">&quot;/home/dje/mydev/hello/platforms/android/cordova/run&quot;</span> --emulator
Platform <span class="s2">&quot;android&quot;</span> deployed to emulator.
</pre>
<ul class="simple">
<li>On obtient le lancement automatique de l'appli</li>
</ul>
<img alt="/images/cordova-2.png" class="align-center" src="/images/cordova-2.png" />
<ul class="simple">
<li>Mais elle se retrouve aussi dans le <em>drawer</em> des applis</li>
</ul>
<img alt="/images/cordova-1.png" class="align-center" src="/images/cordova-1.png" />
<ul class="simple">
<li>ça reste plus que basique pour un <em>hello-world</em>, on peut faire mieux. Le projet <strong>hello</strong> est un site web <strong>dummy</strong>, donc :</li>
<li>Editer <strong>hello/www/index.html</strong></li>
<li>Rajouter :</li>
</ul>
<pre class="code bash literal-block">
    &lt;hr/&gt;
&lt;h1&gt;&lt;a href:<span class="s2">&quot;http://wibfi.virtua-peanuts.net&quot;</span>&gt;Wibfi&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;Lorem ipsum etc caetera&lt;/p&gt;
</pre>
<ul class="simple">
<li>Et relancer un <strong>build</strong></li>
</ul>
<img alt="/images/cordova-3.png" class="align-center" src="/images/cordova-3.png" />
<ul class="simple">
<li>bien mieux !</li>
</ul>
</div>
<div class="section" id="a-noter">
<h2>A Noter</h2>
<ul class="simple">
<li>L'<strong>apk</strong> compilé est disponible dans le dossier <strong>hello/platforms/android/bin</strong> (version debug)... ou <a class="reference external" href="/repo/Helloworld-debug.apk">à télécharger ici</a></li>
</ul>
</div>
